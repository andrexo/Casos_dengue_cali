<!DOCTYPE html>
<html lang="es">
	<head>
	
	     	<link rel="stylesheet" href="https://leaflet.github.io/Leaflet.draw/src/leaflet.draw.css"/>
     	<link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.css"/>
     	<link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.Default.css"/>
	
	
	
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>Leaflet.geoCSV: Test de opciones</title>

      <!-- Leaflet 0.5: https://github.com/CloudMade/Leaflet-->
		<link rel="stylesheet" href="lib/leaflet.css" />
		<!--[if lte IE 8]> <link rel="stylesheet" href="../../lib/leaflet.ie.css" />  <![endif]-->  
		<script src="lib/leaflet.js"></script>

		<!-- GeoCSV: https://github.com/joker-x/Leaflet.geoCSV -->
		<script src="leaflet.geocsv-src.js"></script>

		<!-- CodeMirror -->
		<link rel="stylesheet" href="lib/codemirror/codemirror.css">
		<script src="lib/codemirror/codemirror.js"></script>
		<script src="lib/codemirror/codemirror2.js"></script>
		<script src="lib/codemirror/util/matchbrackets.js"></script>
		<script src="lib/codemirror/mode-javascript.js"></script>

		<style>	
		html, body {
			margin: 0;
			padding: 0;
			font-family: Arial, sans-serif;
			background-color: #eee;
		}
		a {
			text-decoration: none;
		}
		.caja {
			display: block;
			float:left;
			width: 43%;
			margin: 1%;
			padding: 2%;
			border: 1px solid #ccc;
			background-color: #fff;
		}
		#mapa {
			height: 300px;
		}
		h1 {
			margin: 0;
			text-align: center;
			padding: 10px;
			border-bottom: 1px solid #ccc;
			background-color: #fff
		}
		h2 {
			margin-bottom: 5px;
		}
		textarea {
			clear: both;
			width: 100%;
			height: 200px;
			font-family: monospace;
		}
		#cargar {
			margin: 20px 0 0 0;
			font-size: 1.2em;
		}
		.CodeMirror2 {
			border: 1px solid #eee;
			font-size: 1.2em;
			height: auto;
			font-family: monospace;
			visibility:hidden;
		}
		</style>
		
	  	<!-- mapa -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css">
    
    <link rel="stylesheet" href="lib/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.css">
    <script src="lib/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.js"></script>
	
	
	
	
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Marble &mdash; Free HTML5 Bootstrap Website Template by FreeHTML5.co</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by FreeHTML5.co" />
	<meta name="keywords" content="free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="FreeHTML5.co" />


  	<!-- logos facebook y  demás -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- icono moa -->
	<link rel="shortcut icon" href="images/mosquito.ico">

	
	<!-- animaciones  -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	</head>
	
	
	
	
	<body>
	
	
		<div id="fh5co-page">
		<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
		<aside id="fh5co-aside" role="complementary" class="border js-fullheight">

			<h1 id="fh5co-logo"><a href="index.html">Dengue</a></h1>
			<nav id="fh5co-main-menu" role="navigation">
				<ul>
					<li class="fh5co-active"><a href="index.html">Geovisor</a></li>
					<li><a href="datos.html">Datos</a></li>

				</ul>

			</nav>

			<div class="fh5co-footer">
			
				<p><small>&copy; 2020 AFO All Rights Reserved. <span>Designed by <a href="www.univalle.edu.co" target="_blank">Andrés Felipe Ordóñez</a> </span></small></p>
				<ul>
					<li><a href="#"><i class="icon-facebook2"></i></a></li>
					<li><a href="#"><i class="icon-twitter2"></i></a></li>
					<li><a href="#"><i class="icon-instagram"></i></a></li>
					<li><a href="#"><i class="icon-linkedin2"></i></a></li>
				</ul>
						</div>


		</aside>

		<div id="fh5co-main">
			<div id="map"  class="flexslider js-fullheight">  </div>

											<h2 class="fh5co-heading animate-box" data-animate-effect="fadeInLeft">Carga de Datos CSV</h2>
								<textarea  rows="5" cols="55" id="csv" >
					3.43158;-76.423950;París, capital de Francia
					3.5168;-76.523950;Madrid, capital de España
					3.2015;-76.623950;Roma, capital de Italia
					3.1837;-76.723950;Atenas, capital de Grecia</textarea> <br /><br />
								<button id="cargar" >Cargar datos </button>
								

																
			<div class="fh5co-narrow-content">
				<h2 class="fh5co-heading animate-box" data-animate-effect="fadeInLeft">Realizado por</h2>
				<div class="row">
					<div class="col-md-6">
						<div class="fh5co-feature animate-box" data-animate-effect="fadeInLeft">
							<div class="fh5co-icon">
								<i class="icon-settings"></i>
							</div>
							<div class="fh5co-text">
								<h3>Andrés Felipe Ordóñez</h3>
								<p>escriba texto inspirador aqui </p>
							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="fh5co-feature animate-box" data-animate-effect="fadeInLeft">
							<div class="fh5co-icon">
								<i class="icon-search4"></i>
							</div>
							<div class="fh5co-text">
								<h3>segundo integrante</h3>
								<p> escribir algo :v </p>
							</div>
						</div>
					</div>

					<div class="col-md-6">
						<div class="fh5co-feature animate-box" data-animate-effect="fadeInLeft">
							<div class="fh5co-icon">
								<i class="icon-paperplane"></i>
							</div>
							<div class="fh5co-text">
								<h3>El otro Andrés </h3>
								<p>escriba algo </p>
							</div>
						</div>
					</div>

				</div>
			</div>
			<div class="mapid">
				<h2 class="fh5co-heading animate-box" data-animate-effect="fadeInLeft">Encuentre Otros mapas de su interes 	</h2>
				<div class="row row-bottom-padded-md">
					<div class="col-md-3 col-sm-6 col-padding animate-box" data-animate-effect="fadeInLeft">
						<div class="blog-entry">
							<a href="https://www.google.com.co/" class="website"><img src="images/img-1.jpg" class="img-responsive" alt="Free HTML5 Bootstrap Template by FreeHTML5.co"></a>
							<div class="desc">
								<h3>Primer mapa</h3>
								<span><small>quien lo hizo </small>  </span>
								<p>descripcción del mapa</p>
								<a href="https://www.google.com.co/" class="website">Leer más: <i class="icon-arrow-right3"></i></a>
							</div>
						</div>
					</div>
					<div class="col-md-3 col-sm-6 col-padding animate-box" data-animate-effect="fadeInLeft">
						<div class="blog-entry">
							<a href="https://www.google.com.co/" class="website"><img src="images/img-1.jpg" class="img-responsive" alt="Free HTML5 Bootstrap Template by FreeHTML5.co"></a>
							<div class="desc">
								<h3>segundo mapa</h3>
								<span><small>quien lo hizo </small>  </span>
								<p>descripcción del mapa</p>
								<a href="https://www.google.com.co/" class="website" >Leer más: <i class="icon-arrow-right3"></i></a>
							</div>
						</div>
					</div>
					<div class="col-md-3 col-sm-6 col-padding animate-box" data-animate-effect="fadeInLeft">
						<div class="blog-entry">
							<a href="https://www.google.com.co/" class="website"><img src="images/img-1.jpg" class="img-responsive" alt="Free HTML5 Bootstrap Template by FreeHTML5.co"></a>
							<div class="desc">
								<h3>tercer mapa</h3>
								<span><small>quien lo hizo </small>  </span>
								<p>descripcción del mapa</p>
								<a href="https://www.google.com.co/" class="website">Leer más: <i class="icon-arrow-right3"></i></a>
							</div>
						</div>
					</div>
					<div class="col-md-3 col-sm-6 col-padding animate-box" data-animate-effect="fadeInLeft">
						<div class="blog-entry">
							<a href="https://www.google.com.co/" class="website"><img src="images/img-1.jpg" class="img-responsive" alt="Free HTML5 Bootstrap Template by FreeHTML5.co"></a>
							<div class="desc">
								<h3>cuarto mapa</h3>
								<span><small>quien lo hizo </small>  </span>
								<p>descripcción del mapa</p>
								<a href="https://www.google.com.co/" class="website">Leer más: <i class="icon-arrow-right3"></i></a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div id="get-in-touch">
				<div class="fh5co-narrow-content">
					<div class="row">
						<div class="col-md-4 animate-box" data-animate-effect="fadeInLeft">
							<h1 class="fh5co-heading-colored">Universidad del Valle</h1>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6 col-md-offset-3 col-md-pull-3 animate-box" data-animate-effect="fadeInLeft">
							<p class="fh5co-lead">Escuela de ingeniería Civil y Geomática</p>

						</div>
						
					</div>
				</div>
			</div>
		</div>
		
	</div>
	

<div >
										<textarea  id="opciones"   readonly=true >
										L.geoCsv(null,{
										  titles: ['lat', 'lng', 'popup'],
										  fieldSeparator: ';',
										  lineSeparator: '\n',
										  deleteDobleQuotes: true,
										  firstLineTitles: false,
										  onEachFeature: function (feature, layer) {
											var popup = '';
											for (var clave in feature.properties) {
											  var title = geo_csv.getPropertyTitle(clave);
											  popup += '<b>'+title+'</b><br />'+feature.properties[clave]+'<br /><br />';
											}
											layer.bindPopup(popup);
										  }
										});</textarea>

</div>




	



	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
		<script type="text/javascript" src="data/Comunas_1.js"></script>
	<script type="text/javascript" src="data/contagiados_2.js"></script>
	<script src="leaflet.geocsv.js"></script>
	
	
		<script src="js/main.js"></script>

		
		<script>

//codemirror
var opciones_editor = CodeMirror2.fromTextArea(document.getElementById("opciones"), {
  lineNumbers: true,
  matchBrackets: true,
  mode: "text/typescript"});

var csv_editor = CodeMirror.fromTextArea(document.getElementById("csv"), {lineNumbers: true});

//altura del mapa al tamaño de los controles, dos columnas iguales



//instanciamos el mapa


//dotamos de funcionalidad al botón cargar
var geo_csv = {};

function cargar() {
  //guardamos los cambios del usuario en sus respectivos textarea
  opciones_editor.save();
  csv_editor.save();
  //borramos la capa geo_csv del mapa
  map.removeLayer(geo_csv);
  //recreamos la capa con las nuevas opciones
  geo_csv = eval(document.getElementById('opciones').value);
  geo_csv.addData(document.getElementById('csv').value);
  map.addLayer(geo_csv);

}

document.getElementById('cargar').addEventListener('click', cargar, false);

</script>








        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js"></script>
		<script src="https://leaflet.github.io/Leaflet.markercluster/dist/leaflet.markercluster-src.js"></script>
        <script src="src/leaflet.browser.print.js"></script>
        <script src="src/leaflet.browser.print.utils.js"></script>
        <script src="src/leaflet.browser.print.sizes.js"></script>
		<script src="https://leaflet.github.io/Leaflet.markercluster/example/realworld.388.js"></script>


    	<script>
				function getColor(d) {
					return d > 100000000 ? '#800026' : 
					d > 50000000 ? '#BD0026' : 
					d > 20000000 ? '#E31A1C' : 
					d > 10000000 ? '#FC4E2A' : 
					d > 5000000 ? '#FD8D3C' : 
					d > 2000000 ? '#FEB24C' : 
					d > 1000000 ? '#FED976' : 
					'#FFEDA0'; }
					
						function style(feature) { 
					return { 
					fillColor: getColor(
					feature.properties.POP_EST), 
					weight: 2, 
					opacity: 1, 
					color: 'white', 
					dashArray: '3', 
					fillOpacity: 0.7 
					}; 
					}
		
		
		
 				var canvasRenderer = L.canvas();
					//Layers
					var cities = L.markerClusterGroup();







					var mbAttr = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
							'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
							'Imagery © <a href="http://mapbox.com">Mapbox</a>',
						mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

					var grayscale   = L.tileLayer(mbUrl, {id: 'mapbox.light', attribution: mbAttr}),
						streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets',   attribution: mbAttr}),

						wms = L.tileLayer.wms('https://ahocevar.com/geoserver/wms', { layers: 'topp:states', CQL_FILTER: 'PERSONS > 2000000', styles: '', format: 'image/png', transparent: true, });
	

					var map = L.map('map', {
						center: [3.42158, -76.523950],
						zoom: 12,
						layers: [grayscale]
					});

					var baseLayers = {
						"Grayscale": grayscale,
						"Streets": streets,
					};

						var wmsLayer1 = L.tileLayer.wms('http://ows.mundialis.de/services/service?', {
						layers: 'SRTM30-Colored-Hillshade',
						attribution: 'Municipios Valle',
						format: 'image/png',
						transparent: true
						});
						
						
						var marker = L.marker([3.42158, -76.523950]).addTo(map);
						marker.bindPopup("<b>Hola hola care bola</b><br>5.0").openPopup();
						var polygon = L.polygon([[3.43158, -76.423950],[3.52158, -76.613950],[3.51158, -76.503950]]).addTo(map);
						polygon.bindPopup("prueba polygono");
						
							var layers_comunas = new L.geoJson(Comunas_1,{
							attribution: '',
							style: style,
						});
						
						var layers_contagiados = new L.geoJson(contagiados_2,{
							attribution: '',
							style: style,
						});
											


					var overlays = {
							"WMS": wmsLayer1,
							"Marker": marker,
							"Polygon": polygon,
							"Comunas":layers_comunas,
							"Contagiados":layers_contagiados,

					};
					

					L.control.layers(baseLayers, overlays).addTo(map);

			var drawnItems = new L.FeatureGroup();

			var drawControl = new L.Control.Draw({
				position: 'bottomright',
				edit: {
					featureGroup: drawnItems,
					remove: false,
					edit: false
				},
				draw: {
					circlemarker: false,
				}
			});
			map.addControl(drawControl);

			map.createPane("new-pane");

			L.control.scale({position:'topleft'}).addTo(map);

			map.on(L.Draw.Event.CREATED, function (e) {
			    var type = e.layerType,
			        layer = e.layer;

			    if (type === 'marker') {
			        layer.bindPopup('Marcador');
			    }

			    drawnItems.addLayer(layer);
				map.addLayer(drawnItems);
			});

            var green = L.circle([39.73, -104.99], 5000, {
                        color: 'green',
                        fillColor: 'darkgreen',
                        fillOpacity: 0.8,
						pane: "new-pane",
						renderer: canvasRenderer
                    });

            var l = L.layerGroup();
			l.addTo(map)
			l.addLayer(green);

			var customActionToPrint = function(context, mode) {
				return function() {
					window.alert("We are printing the MAP. Let's do Custom print here!");
					context._printCustom(mode);
				}
			}

            L.control.browserPrint({
                printLayer: L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {
                            	attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                            	subdomains: 'abcd',
                            	minZoom: 1,
                            	maxZoom: 16,
                            	ext: 'png'
                            }),
                closePopupsOnPrint: false,
				printModes: [
					L.control.browserPrint.mode.landscape("Vista Tabloide", "Tabloide"),
					L.control.browserPrint.mode("Alerta", "Impresión especificada por el usuario", "A6", customActionToPrint, false),
					L.control.browserPrint.mode.landscape(),
					"PORTrait",
					L.control.browserPrint.mode.auto("Automatica", "B4"),
					L.control.browserPrint.mode.custom("seleción de la zona", "B5")
				]

            }).addTo(map);

 

			var markers = L.markerClusterGroup();

			for (var i = 0; i < addressPoints.length; i++) {
				var a = addressPoints[i];
				var title = a[2];
				var marker = L.marker(new L.LatLng(a[0], a[1]), { title: title });
				marker.bindPopup(title);
				markers.addLayer(marker);
			}

			// We are not cloning markercluster to preserve original clasterization behavior and prevent OutOfMemory problems
			L.Control.BrowserPrint.Utils.registerLayer(L.MarkerClusterGroup, 'L.MarkerClusterGroup', function (layer, utils) {
				return layer;
			});

			// On print end we invalidate markercluster to update markers;
			map.on(L.Control.BrowserPrint.Event.PrintEnd, function(e) {
				map.removeLayer(markers);
				map.addLayer(markers);
			});

			map.addLayer(markers);

    	</script>

	</body>
</html>
